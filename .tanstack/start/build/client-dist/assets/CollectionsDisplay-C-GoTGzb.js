import{ag as j,ah as C,r as m,ai as L,aj as T,c as R,o as D,l as $,e as A,u as N,j as o,b as O,d as w,L as F,g as U,h as W,i as J,k as z,Y as H,ac as Z}from"./main-BBfrF5_e.js";import{c as P}from"./collection-CYD1e6ti.js";import{d as B}from"./CollectionSeedDisplay-DZBrMBWB.js";try{let r=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},e=new r.Error().stack;e&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[e]="2002435f-432d-40fd-ae5f-912aa9a68758",r._sentryDebugIdIdentifier="sentry-dbid-2002435f-432d-40fd-ae5f-912aa9a68758")}catch{}const Q=()=>Array.from({length:4},()=>0);Q();Q();var G=Object.defineProperty,Y=(r,e,s)=>e in r?G(r,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[e]=s,S=(r,e,s)=>Y(r,typeof e!="symbol"?e+"":e,s);class X{constructor(e){S(this,"createWatch"),S(this,"queries"),S(this,"listeners"),this.createWatch=e,this.queries={},this.listeners=new Set}setQueries(e){for(const s of Object.keys(e)){const{query:t,args:n}=e[s];if(j(t),this.queries[s]===void 0)this.addQuery(s,t,n);else{const a=this.queries[s];(j(t)!==j(a.query)||JSON.stringify(C(n))!==JSON.stringify(C(a.args)))&&(this.removeQuery(s),this.addQuery(s,t,n))}}for(const s of Object.keys(this.queries))e[s]===void 0&&this.removeQuery(s)}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}getLocalResults(e){const s={};for(const t of Object.keys(e)){const{query:n,args:a}=e[t];j(n);const l=this.createWatch(n,a);let c;try{c=l.localQueryResult()}catch(u){if(u instanceof Error)c=u;else throw u}s[t]=c}return s}setCreateWatch(e){this.createWatch=e;for(const s of Object.keys(this.queries)){const{query:t,args:n,watch:a}=this.queries[s],l=a.journal();this.removeQuery(s),this.addQuery(s,t,n,l)}}destroy(){for(const e of Object.keys(this.queries))this.removeQuery(e);this.listeners=new Set}addQuery(e,s,t,n){if(this.queries[e]!==void 0)throw new Error(`Tried to add a new query with identifier ${e} when it already exists.`);const a=this.createWatch(s,t,n),l=a.onUpdate(()=>this.notifyListeners());this.queries[e]={query:s,args:t,watch:a,unsubscribe:l}}removeQuery(e){const s=this.queries[e];if(s===void 0)throw new Error(`No query found with identifier ${e}.`);s.unsubscribe(),delete this.queries[e]}notifyListeners(){for(const e of this.listeners)e()}}function V({getCurrentValue:r,subscribe:e}){const[s,t]=m.useState(()=>({getCurrentValue:r,subscribe:e,value:r()}));let n=s.value;return(s.getCurrentValue!==r||s.subscribe!==e)&&(n=r(),t({getCurrentValue:r,subscribe:e,value:n})),m.useEffect(()=>{let a=!1;const l=()=>{a||t(u=>{if(u.getCurrentValue!==r||u.subscribe!==e)return u;const h=r();return u.value===h?u:{...u,value:h}})},c=e(l);return l(),()=>{a=!0,c()}},[r,e]),n}function ee(r){const e=L();if(e===void 0)throw new Error("Could not find Convex client! `useQuery` must be used in the React component tree under `ConvexProvider`. Did you forget it? See https://docs.convex.dev/quick-start#set-up-convex-in-your-react-app");const s=m.useMemo(()=>(t,n,a)=>e.watchQuery(t,n,{journal:a}),[e]);return se(r,s)}function se(r,e){const[s]=m.useState(()=>new X(e));s.createWatch!==e&&s.setCreateWatch(e),m.useEffect(()=>()=>s.destroy(),[s]);const t=m.useMemo(()=>({getCurrentValue:()=>s.getLocalResults(r),subscribe:n=>(s.setQueries(r),s.subscribe(n))}),[s,r]);return V(t)}const te=(r,e,s)=>t=>{const n={...t.queries},a=t.nextPageKey,l=t.nextPageKey+1,c=t.nextPageKey+2;n[a]={query:t.query,args:{...t.args,paginationOpts:{...t.queries[r].args.paginationOpts,endCursor:e}}},n[l]={query:t.query,args:{...t.args,paginationOpts:{...t.queries[r].args.paginationOpts,cursor:e,endCursor:s}}};const u={...t.ongoingSplits};return u[r]=[a,l],{...t,nextPageKey:c,queries:n,ongoingSplits:u}},re=r=>e=>{const s=e.ongoingSplits[r];if(s===void 0)return e;const t={...e.queries};delete t[r];const n={...e.ongoingSplits};delete n[r];let a=e.pageKeys.slice();const l=e.pageKeys.findIndex(c=>c===r);return l>=0&&(a=[...e.pageKeys.slice(0,l),...s,...e.pageKeys.slice(l+1)]),{...e,queries:t,pageKeys:a,ongoingSplits:n}};function ce(r,e,s){if(typeof(s==null?void 0:s.initialNumItems)!="number"||s.initialNumItems<0)throw new Error(`\`options.initialNumItems\` must be a positive number. Received \`${s==null?void 0:s.initialNumItems}\`.`);const t=e==="skip",n=t?{}:e,a=j(r),l=m.useMemo(()=>()=>{const i=ie();return{query:r,args:n,id:i,nextPageKey:1,pageKeys:t?[]:[0],queries:t?{}:{0:{query:r,args:{...n,paginationOpts:{numItems:s.initialNumItems,cursor:null,id:i}}}},ongoingSplits:{},skip:t}},[JSON.stringify(C(n)),a,s.initialNumItems,t]),[c,u]=m.useState(l);let h=c;(j(r)!==j(c.query)||JSON.stringify(C(n))!==JSON.stringify(C(c.args))||t!==c.skip)&&(h=l(),u(h));const x=L().logger,I=ee(h.queries),[d,y]=m.useMemo(()=>{var g,p;let i;const f=[];for(const b of h.pageKeys){if(i=I[b],i===void 0)break;if(i instanceof Error){if(i.message.includes("InvalidCursor")||i instanceof T&&typeof i.data=="object"&&((g=i.data)==null?void 0:g.isConvexSystemError)===!0&&((p=i.data)==null?void 0:p.paginationError)==="InvalidCursor")return x.warn("usePaginatedQuery hit error, resetting pagination state: "+i.message),u(l),[[],void 0];throw i}const v=h.ongoingSplits[b];if(v!==void 0?I[v[0]]!==void 0&&I[v[1]]!==void 0&&u(re(b)):i.splitCursor&&(i.pageStatus==="SplitRecommended"||i.pageStatus==="SplitRequired"||i.page.length>s.initialNumItems*2)&&u(te(b,i.splitCursor,i.continueCursor)),i.pageStatus==="SplitRequired")return[f,void 0];f.push(...i.page)}return[f,i]},[I,h.pageKeys,h.ongoingSplits,s.initialNumItems,l,x]),q=m.useMemo(()=>{if(y===void 0)return h.nextPageKey===1?{status:"LoadingFirstPage",isLoading:!0,loadMore:g=>{}}:{status:"LoadingMore",isLoading:!0,loadMore:g=>{}};if(y.isDone)return{status:"Exhausted",isLoading:!1,loadMore:g=>{}};const i=y.continueCursor;let f=!1;return{status:"CanLoadMore",isLoading:!1,loadMore:g=>{f||(f=!0,u(p=>{const b=[...p.pageKeys,p.nextPageKey],v={...p.queries};return v[p.nextPageKey]={query:p.query,args:{...p.args,paginationOpts:{numItems:g,cursor:i,id:p.id}}},{...p,nextPageKey:p.nextPageKey+1,pageKeys:b,queries:v}}))}}},[y,h.nextPageKey]);return{results:d,...q}}let E=0;function ie(){return E++,E}/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],oe=R("SquarePen",ne),de=D(function({collections:e,likedSeeds:s,likesPending:t,isLoading:n=!1}){const{href:a}=$(),{style:l,steps:c,angle:u}=A({from:"/_layout"}),h=N(P.collections),_=m.useRef(!1);m.useEffect(()=>{n||(_.current=!1,P.collections.set(e))},[e,n]);const x=_.current&&h.length>0?h:e,I=(d,y)=>{const q=Z(d,y.globals),i=x.findIndex(g=>String(g._id)===String(y._id)),f=x.find(g=>String(g._id)===String(y._id));if(i!==-1){const g=[...x];g[i]={...x[i],coeffs:d,seed:q,likes:q!==(f==null?void 0:f.seed)?0:(f==null?void 0:f.likes)||0},_.current=!0,P.collections.set(g)}};return o.jsx("section",{className:"h-full w-full relative",children:o.jsxs("ol",{className:O("h-full w-full relative px-5 lg:px-14","grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 3xl:grid-cols-5 4xl:grid-cols-6 gap-x-10 gap-y-20 auto-rows-[300px]"),children:[x.map((d,y)=>{const i=N(w.activeCollectionId)===d._id,f=N(w.previewStyle),g=N(w.previewSteps),p=N(w.previewAngle),b=N(w.previewSeed),v=g!==null?g:c==="auto"?d.steps:c,k=f!==null?f:l==="auto"?d.style:l,M=p!==null||u!=="auto"?p??(typeof u=="number"?parseFloat(u.toFixed(1)):d.angle):d.angle;return o.jsx("li",{className:O("relative group","w-full font-poppins"),onClick:()=>{i?w.activeCollectionId.set(null):w.activeCollectionId.set(d._id)},onMouseLeave:()=>{b&&w.previewSeed.set(null)},tabIndex:0,role:"button","aria-pressed":i,"aria-label":`${i?"Deselect":"Select"} gradient ${y+1} for actions`,children:o.jsx(B,{collection:d,index:y,likedSeeds:s,style:k,steps:v,angle:M,href:a,onChannelOrderChange:I,itemActive:i,likesPending:t,children:o.jsx("div",{className:O("absolute top-3.5 left-3.5 z-10 transition-opacity",{"opacity-0 group-hover:opacity-100":!i,"opacity-100":i}),children:o.jsx(F,{to:"/$seed",params:{seed:d.seed},search:K=>({...K,angle:u==="auto"?d.angle:K.angle,style:l==="auto"?d.style:K.style,steps:c==="auto"?d.steps:K.steps}),className:"block text-foreground/80 hover:text-foreground transition-colors","aria-label":`View details for gradient ${y+1}`,children:o.jsx("div",{className:"bg-background/20 backdrop-blur-sm rounded-md transition-all flex items-center justify-center px-0.5 z-10 h-8 w-9 hover:bg-background/40",children:o.jsx("div",{className:"p-1.5 rounded-full transition-colors cursor-pointer hover:text-foreground",children:o.jsx(U,{children:o.jsxs(W,{children:[o.jsx(J,{asChild:!0,children:o.jsx(oe,{className:"w-5 h-5 text-foreground"})}),o.jsx(z,{children:o.jsx("span",{children:"Edit Palette"})})]})})})})})})})},d._id)}),n&&o.jsx(o.Fragment,{children:Array.from({length:H}).map((d,y)=>o.jsxs("li",{className:"w-full relative",children:[o.jsx("div",{className:"h-[300px] w-full rounded-lg border-2 border-muted animate-pulse"}),o.jsxs("div",{className:"flex justify-between pt-4 relative",children:[o.jsx("div",{className:"flex items-center"}),o.jsx("div",{className:"flex items-center min-h-[28px]",children:o.jsx("div",{className:"relative text-muted-foreground",children:o.jsx("div",{className:"rounded-full cursor-not-allowed opacity-50",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5.5 h-5.5",children:o.jsx("path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"})})})})})]})]},`placeholder-${y}`))})]})})});export{de as C,ce as u};
//# sourceMappingURL=CollectionsDisplay-C-GoTGzb.js.map
